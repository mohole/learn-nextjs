# Learn Next.js

## 04. Develop a REST API from scratch

Beside giving an opinionated approach to React and allow various techniques of server side render, Next.js also offer some server specific features with the most notable being the option to create **REST API endpoint within the same codebase**.

To explore this concept we will build a simple REST route that:

- expose some activities as JSON
- allow the basic http methods to CRUD (Create Read Update Delete) on activities

To enable persistance but keeping things simple we will use [LowDB](https://github.com/typicode/lowdb) with the `memory connector` to store the data in memory on the server, obviously in the future you may want to switch to a proper database solution connector (MySQL, MongoDB, etc...) especially if we want to build more complex applications than POCs, however the flow of our code would remain more or less the same.

> Note: by using memory storage, the data is persistant **until the server session is active**, so re-deploying the code to Vercel or restarting the server will cause to wipe all the data stored so far.

1. create a new `/api` folder within the `/pages` folder. Every [subfolder created in here will be transformed in a REST route](https://nextjs.org/docs/api-routes/introduction), so to create our endpoint to provide access to excursions activities we will create the following structure:

`/pages/api/excursions/[[id]].ts` --> `localhost:3000/api/excursions`

the `[[id]]` is [a "catch-all" route](https://nextjs.org/docs/api-routes/dynamic-api-routes#optional-catch-all-api-routes) to intercept every method and every request to our endpoint, with and without parameters.

2. Within the file let's start with the basic structure for a "hello world" endpoint:

```typescript
import type { NextApiRequest, NextApiResponse } from "next";
import { Excursion, Message } from "./../../../types/api";

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse<Excursion | Excursion[] | Message>
) {
  res.status(200).json({ message: "hello world!" });
}
```
